#### 1. Улучшение `--watch` (Пересборка только измененного)

> ...при обнаружение изменений запускает пересоздание всех промптов, что вероятно не очень эффективно, как вы считаете, можно ли сделать пересоздание только там где произошли изменения ? Стоит ли оно того ?

**Ответ:** Вы абсолютно правы. Это неэффективно, и **да, это определенно стоит того**, если вы стремитесь сделать инструмент профессиональным и удобным для больших проектов.

**Анализ сложности:**
Это нетривиальная задача. Для ее решения необходимо построить **граф зависимостей**.

**Предлагаемый план реализации:**

1.  **Фаза 1: Сбор зависимостей.**
    *   При первом запуске `compose` (или при изменении `prompts.yml`), необходимо проанализировать конфигурацию и построить карту зависимостей.
    *   Эта карта будет иметь вид: `агент -> [список файлов-источников]`.
    *   Например:
        ```json
        {
          "code-reviewer": [
            "/path/to/.prompt_scribe/prompts.yml",
            "/path/to/.prompt_scribe/personas/code-reviewer.md",
            "/path/to/.prompt_scribe/includes/development-rules.md"
          ],
          "advanced-report-generator": [
            "/path/to/.prompt_scribe/prompts.yml",
            "/path/to/.prompt_scribe/templates/report.jinja2",
            "/path/to/.prompt_scribe/includes/source-data.json"
          ]
        }
        ```

2.  **Фаза 2: Создание обратной карты.**
    *   Для быстрой реакции на изменения файла нужно инвертировать эту карту в структуру: `файл-источник -> [список зависимых агентов]`.
    *   Например:
        ```json
        {
          "/path/to/.prompt_scribe/includes/development-rules.md": ["code-reviewer"],
          "/path/to/.prompt_scribe/prompts.yml": ["code-reviewer", "advanced-report-generator"]
        }
        ```

3.  **Фаза 3: Модификация `ChangeHandler`.**
    *   При срабатывании `watchdog` на изменение файла `event.src_path`:
        *   **Если изменился `prompts.yml`:** Считаем граф невалидным, полностью пересобираем всех агентов и перестраиваем граф.
        *   **Если изменился другой файл:** Находим его в нашей обратной карте. Получаем список агентов, которые от него зависят. Запускаем `_compose_agents` только для этого списка. Если файл не найден в карте, ничего не делаем.

**Вывод:** Эта функция значительно повысит удобство использования и производительность в watch-режиме. Это идеальный кандидат для следующего крупного релиза.